import random
import string
import time
import re # M√≥dulo para express√µes regulares, usado para verificar padr√µes

def avaliar_forca_senha(senha):
    """Avalia a for√ßa da senha e retorna uma classifica√ß√£o."""
    forca = 0
    comprimento = len(senha)

    # 1. Pontua√ß√£o baseada no comprimento
    if comprimento >= 12:
        forca += 3 # Senha longa
    elif comprimento >= 8:
        forca += 1 # Senha de comprimento aceit√°vel

    # 2. Pontua√ß√£o baseada na variedade de caracteres (usando regex para verificar a presen√ßa)
    # Verifica a presen√ßa de min√∫sculas
    if re.search(r'[a-z]', senha):
        forca += 1
    # Verifica a presen√ßa de mai√∫sculas
    if re.search(r'[A-Z]', senha):
        forca += 1
    # Verifica a presen√ßa de n√∫meros
    if re.search(r'[0-9]', senha):
        forca += 1
    # Verifica a presen√ßa de s√≠mbolos
    if re.search(r'[!@#$%^&*()_+={}\[\]|;:"<>,./?]', senha):
        forca += 1

    # 3. Classifica√ß√£o final
    if forca >= 7:
        return "‚≠ê Muito Forte"
    elif forca >= 5:
        return "üí™ Forte"
    elif forca >= 3:
        return "‚ö†Ô∏è Moderada"
    else:
        return "‚ùå Fraca"

def gerar_senha():
    """Gera uma senha forte baseada nas prefer√™ncias do usu√°rio."""

    caracteres = string.ascii_lowercase
    print("‚ú® Gerador de Senhas Seguras com Avalia√ß√£o de For√ßa ‚ú®")

    # [C√≥digo para Coletar Configura√ß√µes e Gerar a Senha - O mesmo do c√≥digo anterior]
    # In√≠cio do bloco de input
    while True:
        try:
            comprimento = int(input("\nDigite o comprimento desejado da senha (ex: 12): "))
            if comprimento <= 0:
                print("O comprimento deve ser um n√∫mero positivo. Tente novamente.")
                continue
            break
        except ValueError:
            print("Entrada inv√°lida. Por favor, digite um n√∫mero inteiro.")

    incluir_maiusculas = input("Incluir letras mai√∫sculas? (s/n): ").lower().startswith('s')
    incluir_numeros = input("Incluir n√∫meros? (s/n): ").lower().startswith('s')
    incluir_simbolos = input("Incluir s√≠mbolos (ex: !@#$%&*)? (s/n): ").lower().startswith('s')

    if incluir_maiusculas:
        caracteres += string.ascii_uppercase
    if incluir_numeros:
        caracteres += string.digits
    if incluir_simbolos:
        caracteres += string.punctuation 
    
    if not caracteres:
        print("\nErro: Nenhum tipo de caractere foi selecionado. Tente novamente.")
        return

    senha = ''.join(random.choice(caracteres) for _ in range(comprimento))
    # Fim do bloco de input e gera√ß√£o
    
    # --- NOVO: Chamada da fun√ß√£o de avalia√ß√£o ---
    forca = avaliar_forca_senha(senha)

    # --- Exibi√ß√£o do Resultado ---
    print("\n" + "="*50)
    print(f"üéâ Sua senha gerada ({comprimento} caracteres):")
    print(f"‚û°Ô∏è **{senha}**")
    print("-" * 50)
    print(f"üìä For√ßa da Senha: **{forca}**")
    print("="*50)
    time.sleep(1)
    print("\nDica: Senhas muito fortes costumam ter 12 ou mais caracteres e variedade de tipos.")

# Execu√ß√£o do script
if __name__ == "__main__":
    gerar_senha()
